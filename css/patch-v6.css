/* patch-v6.css
   هدف: حفظ تم قدیمی + اضافه کردن استایل‌های لازم برای فیچرهای جدید (بای‌لینگوال، کوییز، گرامر پیشرفته)
*/
:root{
  --chip: color-mix(in srgb, var(--card) 70%, transparent);
}

/* ---------- Bilingual reveal (click EN to show FA) ---------- */
.bi-line{ margin-top:8px; }
.bi-line .en{ cursor:pointer; font-weight:650; }
.bi-line .fa{ margin-top:6px; direction:rtl; text-align:right; color:var(--muted); line-height:1.8; }
.isHidden{ display:none !important; }
.toggle-fa.isOpen{ opacity:.9; }

/* ---------- Quiz card ---------- */
.quiz-card{ padding:14px; border:1px solid var(--border); border-radius:16px; background:color-mix(in srgb, var(--card) 92%, transparent); }
.quiz-q{ font-weight:700; margin-bottom:10px; }
.quiz-opts{ display:grid; gap:10px; }
.quiz-opt{
  text-align:left;
  border:1px solid var(--border);
  border-radius:14px;
  background:color-mix(in srgb, var(--bg) 65%, transparent);
  padding:10px 12px;
  cursor:pointer;
}
.quiz-opt:hover{ transform: translateY(-1px); }
.quiz-opt.is-correct{ border-color: color-mix(in srgb, var(--accent) 70%, var(--border)); }
.quiz-opt.is-wrong{ border-color: color-mix(in srgb, #ef4444 70%, var(--border)); }
details.answer{ margin-top:10px; }

/* ---------- Grammar blocks (new schema) ---------- */
.grammarBlocks{ display:grid; gap:12px; margin-top:10px; }
.grammarBlock{
  border:1px solid var(--border);
  border-radius:18px;
  padding:14px 14px;
  background:color-mix(in srgb, var(--card) 92%, transparent);
}
.grammarHead{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:12px;
  margin-bottom:8px;
}
.grammarHead h6{ margin:0; font-size:1rem; line-height:1.35; }
.gBadge{
  font-size:.78rem;
  padding:5px 10px;
  border:1px solid var(--border);
  border-radius:999px;
  background:var(--chip);
  opacity:.95;
  white-space:nowrap;
}
.pillRow{ display:flex; flex-wrap:wrap; gap:8px; margin-top:8px; }
.pill{
  padding:5px 10px;
  border-radius:999px;
  border:1px solid var(--border);
  background:var(--chip);
  font-size:.82rem;
}
.exampleList{
  list-style:none;
  padding:0;
  margin:10px 0 0;
  display:grid;
  gap:10px;
}
.exampleList li{
  border:1px solid var(--border);
  border-radius:14px;
  padding:10px 12px;
  background:color-mix(in srgb, var(--bg) 65%, transparent);
}
.exampleMeta{
  display:flex;
  gap:8px;
  align-items:center;
  margin-bottom:6px;
}
.metaPill{
  padding:4px 9px;
  border-radius:999px;
  border:1px solid var(--border);
  background:var(--chip);
  font-size:.75rem;
  opacity:.95;
}

/* ---------- Collocation items (if used) ---------- */
.colloc-list{ display:grid; gap:12px; }
.colloc-item{ padding:14px; border:1px solid var(--border); border-radius:18px; background:color-mix(in srgb, var(--card) 92%, transparent); }


/* ---------- Small chips (synonyms/antonyms) ---------- */
.grid2{ display:grid; grid-template-columns: 1fr 1fr; gap:14px; }
@media (max-width: 720px){ .grid2{ grid-template-columns:1fr; } }
.chips{ display:flex; flex-wrap:wrap; gap:8px; margin-top:8px; }
.chip{
  display:inline-flex; align-items:center;
  padding:6px 10px;
  border-radius:999px;
  background: var(--chip);
  border:1px solid color-mix(in srgb, var(--text) 12%, transparent);
  font-size: 13px;
  line-height:1;
}



/* ---------- Dictionary page responsiveness ---------- */
.page-dictionary .row{ flex-wrap:wrap; }
.page-dictionary #matches{ max-height: 52vh; overflow:auto; }
.page-dictionary #entry{ max-height: 52vh; overflow:auto; }
@media (max-width: 880px){
  .page-dictionary .header-inner nav{ overflow:auto; white-space:nowrap; }
  .page-dictionary .row.gap-md{ flex-direction:column; }
  .page-dictionary .col.col-6{ width:100% !important; flex: 1 1 auto !important; }
  .page-dictionary .col.col-auto{ width:100% !important; }
  .page-dictionary #btnClear{ width:100%; margin-top: 8px; }
}
@media (max-width: 520px){
  .page-dictionary .card-title{ font-size: 1.15rem; }
  .page-dictionary .subcard-header{ flex-direction:column; align-items:flex-start; gap:6px; }
}

/* ---------- Selection lookup button ---------- */
.sel-lookup-btn{
  position:absolute;
  z-index:9999;
  padding:8px 10px;
  border-radius:12px;
  border:1px solid color-mix(in srgb, var(--border) 80%, transparent);
  background: color-mix(in srgb, var(--card) 86%, black);
  color: var(--text, #e5e7eb);
  font-weight:650;
  box-shadow: 0 10px 30px rgba(0,0,0,.35);
  cursor:pointer;
}
.sel-lookup-btn:hover{ transform: translateY(-1px); }



/* ===== v11 Responsive + Dictionary (letter-based) ===== */

/* Dictionary matches as chips */
#matches.list{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  align-items:flex-start;
}
#matches.list .match-item{
  display:inline-flex;
  align-items:center;
  padding:6px 10px;
  border:1px solid var(--border);
  border-radius:999px;
  background:var(--bg-card);
  color:inherit;
  text-decoration:none;
  max-width:100%;
}
#matches.list .match-item:hover{ transform: translateY(-1px); }

/* Dictionary entry chips */
.dictChips{ margin-top:14px; display:grid; gap:12px; }
.chipGroup{ padding:10px; border:1px solid var(--border); border-radius:14px; background:var(--bg-card); }
.chipTitle{ font-weight:700; margin-bottom:8px; }
.chipRow{ display:flex; flex-wrap:wrap; gap:8px; }
.chipRow .chip{
  display:inline-flex;
  padding:6px 10px;
  border:1px solid var(--border);
  border-radius:999px;
  text-decoration:none;
  color:inherit;
  background:rgba(255,255,255,0.02);
}
.chipRow .chip:hover{ transform: translateY(-1px); }

/* Lesson tables / long code blocks */
.lesson-details table,
.lesson-details .table{
  width:100%;
  max-width:100%;
}
.lesson-details table{
  display:block;
  overflow-x:auto;
  -webkit-overflow-scrolling: touch;
}
.lesson-details table thead,
.lesson-details table tbody,
.lesson-details table tr{
  width:100%;
}
.lesson-details pre{
  max-width:100%;
  overflow:auto;
}

/* General small-screen tightening */
@media (max-width: 720px){
  .container{ padding-left:14px; padding-right:14px; }
  .subcard{ padding:14px; }
  .card{ padding:14px; }
  .lesson-layout{ grid-template-columns: 1fr; }
  .lesson-toc{
    position: static;
    top:auto;
    max-height:none;
    margin-bottom: 12px;
  }
  .subcard-header{
    flex-direction:column;
    align-items:flex-start;
    gap:8px;
  }
}

@media (max-width: 420px){
  #matches.list .match-item{ width:100%; justify-content:space-between; }
  .chipRow .chip{ width:100%; justify-content:space-between; }
}

.lesson-details img{max-width:100%;height:auto;}


/* === v12 FA toggle system === */
.fa-toggle-btn{
  display:inline-flex;
  align-items:center;
  gap:.35rem;
  padding:.35rem .55rem;
  border-radius:.6rem;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: inherit;
  font: inherit;
  cursor:pointer;
  user-select:none;
}
.fa-toggle-btn:hover{ background: rgba(255,255,255,.10); }
.fa-toggle-btn:active{ transform: translateY(1px); }
.fa-hidden{ display:none !important; }
.fa-shown{ display:block; }
/* Persian blocks nicer */
.fa-block{
  direction: rtl;
  text-align: right;
  padding: .55rem .7rem;
  border-radius: .9rem;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.04);
  margin-top: .35rem;
}
/* === v12 Dictionary + Word responsive tweaks === */
@media (max-width: 760px){
  .page-lesson .lesson-header,
  .page-lesson .lesson-meta{ gap:.6rem; }
  .page-lesson .lesson-grid{ grid-template-columns: 1fr !important; }
  .page-lesson .lesson-toc{ position: static !important; max-height: none !important; }
  .page-lesson .lesson-content{ padding: .9rem !important; }
  .page-dictionary .dict-grid{ grid-template-columns:1fr !important; }
  .page-word .word-grid{ grid-template-columns:1fr !important; }
  .page-word .chip-row{ flex-wrap:wrap !important; }
}


/* === v13: linkified English words in lessons === */
.word-link{
  text-decoration: underline;
  text-decoration-thickness: .08em;
  text-underline-offset: .15em;
  cursor: pointer;
}
.word-link:hover{ filter: brightness(1.08); }

/* === v13: stronger responsive for lesson pages === */
@media (max-width: 980px){
  .page-lesson .lesson-grid{ grid-template-columns: 1fr !important; }
  .page-lesson .lesson-toc{ position: static !important; max-height: none !important; }
}
@media (max-width: 520px){
  .appHeader{ padding: .75rem .75rem !important; }
  .container{ padding-left: .75rem !important; padding-right: .75rem !important; }
  .page-lesson .lesson-content{ padding: .85rem !important; }
}
